<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendrier des √âv√©nements - Association Sportive</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <ul>
            <li><a href="index.html">Accueil</a></li>
            <li><a href="equipe.html">Notre √âquipe</a></li>
            <li><a href="calendrier.html">Calendrier</a></li>
            <li><a href="historique.html">Historique des Tournois</a></li>
            <li><a href="tournoi.html">Arbre de Tournoi</a></li>
        </ul>
    </nav>

    <!-- Indicateur de connexion admin -->
    <div class="admin-indicator" id="adminIndicator">
        <span>üë§ Admin connect√©</span>
        <button class="btn-logout" onclick="logoutAdmin()">D√©connexion</button>
    </div>

    <div class="container large">
        <div class="page-header animate-on-scroll">
            <h1>Calendrier des √âv√©nements</h1>
            <p>Restez inform√© de tous nos √©v√©nements √† venir</p>
        </div>

        <!-- Panneau d'administration -->
        <div class="admin-panel" id="adminPanel">
            <h2>Gestion des √âv√©nements</h2>
            <div class="admin-controls active">
                <div class="control-group">
                    <label for="eventName">Nom de l'√©v√©nement:</label>
                    <input type="text" id="eventName" placeholder="Ex: Tournoi d'Automne 2025">
                </div>
                <div class="control-group">
                    <label for="eventDate">Date:</label>
                    <input type="date" id="eventDate">
                </div>
                <div class="control-group">
                    <label for="eventTime">Heure:</label>
                    <input type="time" id="eventTime" value="14:00">
                </div>
                <div class="control-group">
                    <label for="eventLocation">Lieu:</label>
                    <input type="text" id="eventLocation" placeholder="Ex: Stade Central">
                </div>
                <div class="control-group" style="grid-column: 1 / -1;">
                    <label for="eventDescription">Description:</label>
                    <textarea id="eventDescription" placeholder="Description de l'√©v√©nement..." rows="3"></textarea>
                </div>
                <div class="control-group">
                    <label for="eventParticipants">Nombre d'√©quipes:</label>
                    <input type="number" id="eventParticipants" placeholder="16" min="2" max="64">
                </div>
                <div class="control-group">
                    <label for="eventStatus">Statut:</label>
                    <select id="eventStatus">
                        <option value="upcoming">√Ä venir</option>
                        <option value="ongoing">En cours</option>
                        <option value="completed">Termin√©</option>
                    </select>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="addEvent()">‚ûï Ajouter l'√âv√©nement</button>
                <button class="btn btn-danger" onclick="clearForm()">üîÑ R√©initialiser le formulaire</button>
            </div>
        </div>

        <!-- Compte √† rebours -->
        <div class="countdown-section animate-on-scroll animate-delay-1" id="countdownSection">
            <h2>Prochain √âv√©nement</h2>
            <div class="countdown-event-name" id="nextEventName">Tournoi d'Hiver 2025</div>
            <div class="countdown-timer" id="countdownTimer">
                <div class="countdown-block">
                    <div class="countdown-number" id="days">00</div>
                    <div class="countdown-label">Jours</div>
                </div>
                <div class="countdown-block">
                    <div class="countdown-number" id="hours">00</div>
                    <div class="countdown-label">Heures</div>
                </div>
                <div class="countdown-block">
                    <div class="countdown-number" id="minutes">00</div>
                    <div class="countdown-label">Minutes</div>
                </div>
                <div class="countdown-block">
                    <div class="countdown-number" id="seconds">00</div>
                    <div class="countdown-label">Secondes</div>
                </div>
            </div>
        </div>

        <!-- Liste des √©v√©nements -->
        <div class="events-grid" id="eventsGrid">
            <!-- Les √©v√©nements seront g√©n√©r√©s ici -->
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Association Sportive - Tous droits r√©serv√©s</p>
    </footer>

    <script>
        // V√©rifier si l'utilisateur est admin
        function checkAdminSession() {
            const isAdmin = localStorage.getItem('adminLoggedIn') === 'true';
            if (isAdmin) {
                document.getElementById('adminIndicator').classList.add('show');
                document.getElementById('adminPanel').style.display = 'block';
            } else {
                document.getElementById('adminPanel').style.display = 'none';
            }
        }

        // D√©connexion admin
        function logoutAdmin() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                localStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminLoginTime');
                document.getElementById('adminIndicator').classList.remove('show');
                document.getElementById('adminPanel').style.display = 'none';
            }
        }

        // Base de donn√©es des √©v√©nements par d√©faut
        const defaultEvents = [
            {
                id: 1,
                name: "Tournoi d'Hiver 2025",
                date: "2025-12-15",
                time: "14:00",
                location: "Complexe Sportif Municipal",
                description: "Le grand tournoi d'hiver qui rassemble les meilleures √©quipes de la r√©gion pour une comp√©tition acharn√©e.",
                participants: "16 √©quipes",
                status: "upcoming"
            },
            {
                id: 2,
                name: "Coupe de Printemps",
                date: "2025-04-20",
                time: "10:00",
                location: "Stade Central",
                description: "Tournoi amical pour c√©l√©brer le retour du beau temps avec de nouvelles √©quipes.",
                participants: "8 √©quipes",
                status: "upcoming"
            },
            {
                id: 3,
                name: "Championnat d'√ât√©",
                date: "2025-07-10",
                time: "09:00",
                location: "Arena Sportive",
                description: "Le championnat estival qui d√©terminera le champion de la saison.",
                participants: "32 √©quipes",
                status: "upcoming"
            },
            {
                id: 4,
                name: "Tournoi de No√´l",
                date: "2024-12-25",
                time: "15:00",
                location: "Complexe Sportif",
                description: "√âv√©nement festif de fin d'ann√©e avec animations et surprises.",
                participants: "12 √©quipes",
                status: "completed"
            }
        ];

        // Charger les √©v√©nements depuis localStorage ou utiliser les √©v√©nements par d√©faut
        let events = [];

        function loadEvents() {
            const savedEvents = localStorage.getItem('calendarEvents');
            if (savedEvents) {
                events = JSON.parse(savedEvents);
            } else {
                events = [...defaultEvents];
                saveEvents();
            }
        }

        function saveEvents() {
            localStorage.setItem('calendarEvents', JSON.stringify(events));
        }

        // Fonction pour ajouter un √©v√©nement
        function addEvent() {
            const name = document.getElementById('eventName').value;
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            const location = document.getElementById('eventLocation').value;
            const description = document.getElementById('eventDescription').value;
            const participants = document.getElementById('eventParticipants').value;
            const status = document.getElementById('eventStatus').value;

            if (!name || !date || !time || !location || !description) {
                alert('Veuillez remplir tous les champs obligatoires.');
                return;
            }

            const newEvent = {
                id: Date.now(),
                name: name,
                date: date,
                time: time,
                location: location,
                description: description,
                participants: participants ? `${participants} √©quipes` : '8 √©quipes',
                status: status
            };

            events.push(newEvent);
            saveEvents();
            clearForm();
            displayEvents();
            updateCountdown();

            alert('√âv√©nement ajout√© avec succ√®s !');
        }

        // Fonction pour supprimer un √©v√©nement
        function deleteEvent(eventId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cet √©v√©nement ?')) {
                events = events.filter(e => e.id !== eventId);
                saveEvents();
                displayEvents();
                updateCountdown();
            }
        }

        // Fonction pour r√©initialiser le formulaire
        function clearForm() {
            document.getElementById('eventName').value = '';
            document.getElementById('eventDate').value = '';
            document.getElementById('eventTime').value = '14:00';
            document.getElementById('eventLocation').value = '';
            document.getElementById('eventDescription').value = '';
            document.getElementById('eventParticipants').value = '';
            document.getElementById('eventStatus').value = 'upcoming';
        }

        // Fonction pour calculer le compte √† rebours
        function updateCountdown() {
            // Trouver le prochain √©v√©nement
            const now = new Date().getTime();
            const upcomingEvents = events
                .filter(e => new Date(e.date + ' ' + e.time).getTime() > now)
                .sort((a, b) => new Date(a.date + ' ' + a.time) - new Date(b.date + ' ' + b.time));

            if (upcomingEvents.length === 0) {
                document.getElementById('countdownSection').innerHTML = `
                    <h2>Aucun √©v√©nement √† venir</h2>
                    <p style="margin-top: 1rem; font-size: 1.2rem;">Restez √† l'√©coute pour de nouveaux tournois !</p>
                `;
                return;
            }

            const nextEvent = upcomingEvents[0];
            document.getElementById('nextEventName').textContent = nextEvent.name;

            const eventDate = new Date(nextEvent.date + ' ' + nextEvent.time).getTime();

            const interval = setInterval(function() {
                const now = new Date().getTime();
                const distance = eventDate - now;

                if (distance < 0) {
                    clearInterval(interval);
                    document.getElementById('countdownTimer').innerHTML = `
                        <p style="font-size: 1.5rem; font-weight: 600;">L'√©v√©nement a commenc√© !</p>
                    `;
                    return;
                }

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                document.getElementById('days').textContent = String(days).padStart(2, '0');
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
            }, 1000);
        }

        // Fonction pour formater la date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('fr-FR', options);
        }

        // Fonction pour afficher les √©v√©nements
        function displayEvents() {
            const eventsGrid = document.getElementById('eventsGrid');
            eventsGrid.innerHTML = '';

            // Trier les √©v√©nements par date
            const sortedEvents = [...events].sort((a, b) =>
                new Date(b.date) - new Date(a.date)
            );

            const isAdmin = localStorage.getItem('adminLoggedIn') === 'true';

            sortedEvents.forEach((event, index) => {
                const eventCard = document.createElement('div');
                eventCard.className = `event-card animate-on-scroll animate-delay-${Math.min(index + 2, 6)}`;

                const statusText = {
                    'upcoming': '√Ä venir',
                    'ongoing': 'En cours',
                    'completed': 'Termin√©'
                };

                const deleteButton = isAdmin ? `
                    <button class="btn-delete-event" onclick="deleteEvent(${event.id})" title="Supprimer cet √©v√©nement">
                        üóëÔ∏è Supprimer
                    </button>
                ` : '';

                eventCard.innerHTML = `
                    <div class="event-date-badge">${formatDate(event.date)}</div>
                    <h3>${event.name}</h3>
                    <p>${event.description}</p>
                    <div class="event-details">
                        <div class="event-detail-item">
                            <span class="event-detail-icon">üïê</span>
                            <span>${event.time}</span>
                        </div>
                        <div class="event-detail-item">
                            <span class="event-detail-icon">üìç</span>
                            <span>${event.location}</span>
                        </div>
                        <div class="event-detail-item">
                            <span class="event-detail-icon">üë•</span>
                            <span>${event.participants}</span>
                        </div>
                    </div>
                    <div class="event-status ${event.status}">
                        ${statusText[event.status]}
                    </div>
                    ${deleteButton}
                `;

                eventsGrid.appendChild(eventCard);
            });
        }

        // Initialisation
        window.onload = function() {
            checkAdminSession();
            loadEvents();
            updateCountdown();
            displayEvents();
        };
    </script>
</body>
</html>
